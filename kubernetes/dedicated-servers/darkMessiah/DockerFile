FROM cm2network/steamcmd:latest

USER root
WORKDIR /home/steam

# 2. Descarga el servidor dedicado (Windows)
RUN steamcmd +login anonymous \
    +force_install_dir /home/steam/dm_srv \
    +app_update 2145 validate \
    +quit

# 3. Copia el script de arranque, asign√°ndolo al usuario steam
COPY --chown=steam:steam start.sh .

# 4. Volvemos a steam useer
USER steam
ENTRYPOINT ["bash", "start.sh"]